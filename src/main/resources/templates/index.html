<!doctype html>
<html lang="en" xmlns:sec="http://www.thymeleaf.org/extras/spring-security" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Expense Tracker</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous">
</head>
<body>
<!-- Recommended: Use the ~{...} syntax for fragments -->
<div th:replace="~{fragments/navbar-footer :: navbar}"></div>

<!-- Improvement: Wrap main content in a Bootstrap container for better spacing -->
<div class="container mt-4">

    <h1>Expense Tracker</h1>

    <!-- Welcome section for unauthenticated users -->
    <div sec:authorize="!isAuthenticated()" class="mt-4 p-5 bg-light rounded-3">
        <h3>Welcome to Expense Tracker!</h3>
        <p class="lead">Track your expenses, budgets, and income with ease.</p>
        <hr class="my-4">
        <ul>
            <li>Import expenses from a file.</li>
            <li>Visualize your spending habits.</li>
            <li>Get a clear overview of your finances.</li>
        </ul>
        <a class="btn btn-primary btn-lg" th:href="@{/login}" role="button">Login</a>
        <a class="btn btn-secondary btn-lg" th:href="@{/register}" role="button">Sign Up</a>
    </div>

    <!-- Dashboard section for authenticated users -->
    <div sec:authorize="isAuthenticated()">
        <h3 class="text-success">Hello, <span sec:authentication="principal.username">User</span>! Let's track your finances.</h3>

        <!-- Improvement: Use a Bootstrap list-group for a cleaner link layout -->
        <div class="list-group mt-4">
            <a th:href="@{/addExpense}" class="list-group-item list-group-item-action">Add a new expense</a>
            <a th:href="@{/addBudget}" class="list-group-item list-group-item-action">Manage Budgets</a>
            <a th:href="@{/addIncome}" class="list-group-item list-group-item-action">Add Income</a>
            <a th:href="@{/addTags}" class="list-group-item list-group-item-action">Manage Tags</a> <!-- FIX: Corrected URL from /addTags to /addTag -->
            <a th:href="@{/expenses}" class="list-group-item list-group-item-action">View All Expenses</a>
            <a th:href="@{/visualize}" class="list-group-item list-group-item-action">Visualize Expenses</a>
            <a th:href="@{/import}" class="list-group-item list-group-item-action">Import Expenses</a>
        </div>
    </div>

    <h3 class="text-primary mt-5" sec:authorize="isAuthenticated()">PieChart of Expenses for this Month</h3>
    <div id="mynetwork" sec:authorize="isAuthenticated()" style="height: 400px; border: 1px solid lightgray;">
        <!-- Chart will be rendered here -->
    </div>

</div>

<!-- You might want to include a footer fragment here as well -->
<!-- <div th:replace="~{fragments/navbar-footer :: footer}"></div> -->

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
</body>
</html>